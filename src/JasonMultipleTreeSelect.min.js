!function(e){function t(e){return Number(Math.random().toString().substr(3,e)+(new Date).getTime()).toString(36)}function n(){var e,t,n=document.createElement("DIV");return n.style.cssText="position:absolute; top:-1000px; width:100px; height:100px; overflow:hidden;",e=document.body.appendChild(n).clientWidth,n.style.overflowY="scroll",t=n.clientWidth,document.body.removeChild(n),e-t}var i={textLabel:"",zNodes:[],async:{enable:!1,url:""},callback:{onCheck:function(){}},chkStyle:"checkbox",radioType:"all"},a=function(t,n){this.$target_element=e(t),_self=this;var a=function(){return e.extend({},i,n,_self.$target_element.data())};this.options=s(new a),this.init()},s=function(e){var t={};e instanceof Array&&(t=[]);for(var n in e){var i=e[n];t[n]="object"==typeof i?s(i):i}return t};a.prototype={constructor:a,init:function(){this.targetOffset=this.$target_element.offset(),this.$target_element.nameLabel=this.$target_element.attr("name"),this.$target_element.idLabel=this.$target_element.attr("id"),this.$target_element.checks=this.$target_element.attr("checks"),(void 0===this.$target_element.idLabel||""===this.$target_element.idLabel)&&(this.$target_element.idLabel=t(3)),(void 0===this.$target_element.nameLabel||""===this.$target_element.nameLabel)&&(this.$target_element.nameLabel=t(3)),this.$target_element.attr("name",""===this.options.textLabel?this.$target_element.nameLabel+"text":this.options.textLabel),this.init_tree_container=l.call(this),this.init_ztree=o.call(this),r.call(this)},getChecks:function(e){var t=this.$zTreeObj;nodes=t.getCheckedNodes(!0),v="",rv="";for(var n=0,i=nodes.length;i>n;n++)v+=nodes[n].name+",",rv+=nodes[n].id+",";return v.length>0&&(v=v.substring(0,v.length-1)),rv.length>0&&(rv=rv.substring(0,rv.length-1)),"val"===e?rv:"text"===e?v:void 0}};var r=function(){var t=(this.$target_element.offset(),this.$target_element.outerHeight(),this.tree_container.click(function(e){e.stopPropagation()}));this.$target_element.click(function(e){e.stopPropagation(),t.is(":visible")?t.slideUp("fast"):t.slideDown("fast")}),e(document).click(function(){t.slideUp("fast")})},l=function(){return this.ztreeid=this.$target_element.idLabel+"_zTree",this.$target_element.css({display:"block"}),this.all_container=this.$target_element.wrap('<div class="mts-container" style="inline-block; "/>').parent(),this.tree_container=e('<div   class="menuContent" style="display:none; position: absolute;z-index:110004" ><ul id="'+this.ztreeid+'" class="ztree" style="margin-top:0; width:'+(this.$target_element.width()-n())+'; height: 200px;background-color: white"></ul></div>').insertAfter(this.$target_element),this.checked_val_element=e('<input type="hidden" name="'+this.$target_element.nameLabel+'">').insertAfter(this.tree_container),this},o=function(){var t=this.$target_element,n=this.checked_val_element,i=this.$target_element.checks,a=this.options.callback.onCheck;ztreeonAsyncSuccess=function(e,t,n,i){o.setting.callback.onCheck()};var s=function(e,t){if(""!=e&&void 0!=e&&null!=e)for(var n=e.split(","),i=0;i<t.length;i++)for(var a=0;a<n.length;a++)""+t[i].id===n[a]&&(t[i].checked=!0);return t},r=function(e,i,s){nodes=o.getCheckedNodes(!0),v="",rv="";for(var r=0,l=nodes.length;l>r;r++)v+=nodes[r].name+",",rv+=nodes[r].id+",";v.length>0&&(v=v.substring(0,v.length-1)),rv.length>0&&(rv=rv.substring(0,rv.length-1)),t.val(v),n.attr("value",rv),a()},l={check:{enable:!0,chkboxType:{Y:"",N:""},chkStyle:this.options.chkStyle,radioType:this.options.radioType},view:{dblClickExpand:!1},data:{simpleData:{enable:!0}},callback:{onCheck:r,onAsyncSuccess:ztreeonAsyncSuccess,onClick:function(e,t,n,i){o.checkNode(n,!n.checked,!0),o.setting.callback.onCheck()}},async:this.options.async};l.async.dataFilter=function(e,t,n){return n&&s(i,n),n},this.options.zNodes=s(i,this.options.zNodes);var o=e.fn.zTree.init(e("#"+this.ztreeid),l,this.options.zNodes);return o.setting.callback.onCheck(),this.$zTreeObj=o,this},c=function(t,n){this.$target_element=e(t),this.$target_element.hide()};e.fn.drawNormalTree=function(t){return this.each(function(){e.data(this,"drawTree")||e.data(this,"drawTree",new c(this,t))})},e.fn.drawMultipleTree=function(t){var n,i=arguments[0];return args=arguments,this.each(function(){var s=e(this);data=s.data("drawMultipleTree"),data||e.data(this,"drawMultipleTree",new a(this,t)),"string"==typeof i&&(n=data[i](args[1]))}),"undefined"!=typeof n?n:this}}(jQuery);